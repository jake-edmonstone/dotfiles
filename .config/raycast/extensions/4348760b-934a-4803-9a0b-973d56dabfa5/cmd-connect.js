"use strict";var g=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var T=(t,n)=>{for(var i in n)g(t,i,{get:n[i],enumerable:!0})},W=(t,n,i,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of b(n))!C.call(t,s)&&s!==i&&g(t,s,{get:()=>n[s],enumerable:!(o=P(n,s))||o.enumerable});return t};var v=t=>W(g({},"__esModule",{value:!0}),t);var B={};T(B,{default:()=>A});module.exports=v(B);var l=require("react"),e=require("@raycast/api");var p=require("child_process");var c=Object.assign({},process.env,{PATH:"/usr/local/bin:/usr/bin:/opt/homebrew/bin:/run/current-system/sw/bin"});function d(){return new Promise((t,n)=>{(0,p.exec)("sesh list --json",{env:c},(i,o,s)=>{if(i||s)return n("Please upgrade to the latest version of the sesh CLI");let a=JSON.parse(o);return t(a??[])})})}function S(t){return new Promise((n,i)=>{(0,p.exec)(`sesh connect --switch "${t}"`,{env:c},(o,s,a)=>o||a?(console.error("error ",o),console.error("stderr ",a),i(o?.message??a)):n())})}function w(){return new Promise(t=>{(0,p.exec)("tmux ls",{env:c},(n,i,o)=>t(!(n||o)))})}var x=require("@raycast/api"),h=require("child_process");function y(){let{openWithApp:t}=(0,x.getPreferenceValues)();return new Promise((n,i)=>{(0,h.exec)(`open -a ${t.name}`,{env:c},(o,s,a)=>o||a?i(o?.message??a):n())})}var u=require("react/jsx-runtime");function I(t){switch(t.Src){case"tmux":return{source:e.Icon.Bolt,tintColor:t.Attached>=1?e.Color.Green:e.Color.Blue,tooltip:t.Attached>=1?"Attached":"Detached"};case"tmuxinator":return{source:e.Icon.Box,tintColor:e.Color.Magenta};case"config":return{source:e.Icon.Cog,tintColor:e.Color.SecondaryText};case"zoxide":default:return{source:e.Icon.Folder,tintColor:e.Color.SecondaryText}}}function L(t){if(t!==0)return String(Number.isInteger(t)?t:t.toFixed(2))}function A(){let[t,n]=(0,l.useState)([]),[i,o]=(0,l.useState)(!0);async function s(){try{let r=await d();n(r)}catch(r){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Couldn't get sessions",message:typeof r=="string"?r:"Unknown reason"})}finally{o(!1)}}(0,l.useEffect)(()=>{(async()=>{if(!await w()){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"tmux isn't running",message:"Please start tmux before using this command."}),o(!1);return}await s()})()},[]);async function a(r){try{o(!0),await S(r),await y(),await(0,e.closeMainWindow)(),await(0,e.clearSearchBar)()}catch(m){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Couldn't connect to session",message:typeof m=="string"?m:"Unknown reason"})}finally{o(!1)}}return(0,u.jsx)(e.List,{isLoading:i,children:t.map((r,m)=>{let f=[];return r.Src==="tmux"?f.push({icon:e.Icon.AppWindow,text:String(r.Windows),tooltip:r.Windows===1?"Window":"Windows"}):f.push({text:L(r.Score),icon:r.Src==="tmuxinator"?e.Icon.Box:e.Icon.Racket,tooltip:"Score"}),(0,u.jsx)(e.List.Item,{title:r.Name,icon:I(r),accessories:f,actions:(0,u.jsx)(e.ActionPanel,{children:(0,u.jsx)(e.Action,{title:"Connect to Session",onAction:()=>a(r.Name)})})},m)})})}
